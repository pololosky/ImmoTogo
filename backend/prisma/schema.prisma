// schema.prisma

generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

// Utilisateur (vendeur ou acheteur potentiel)

model User {
  id            Int         @id @default(autoincrement())
  email         String      @unique
  name          String?
  password      String
  phone         String?
  // Nouveau champ pour stocker un token (ex: réinitialisation de mot de passe, vérification d'email)
  token         String?     @unique
  // Nouveau champ pour définir la date d'expiration du token
  tokenExpiry   DateTime?

  properties    Property[] // Les biens mis en vente par cet utilisateur

  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt
}

// Type de bien (Maison, Appartement, Terrain)
enum PropertyType {
  APPARTEMENT
  MAISON
  TERRAIN
  VILLA
  MAGASIN
  BUREAU
}


// Bien immobilier en vente
model Property {
  id             Int          @id @default(autoincrement())
  title          String
  description    String?
  price          Decimal      @db.Decimal(12, 2)
  surface        Int
  rooms          Int?
  address        String
  city           String
  zipCode        String
  type           PropertyType
  isSold         Boolean      @default(false)
  images         String[]     @default([])
  published      Boolean      @default(true)
  isFavorite     Boolean      @default(false)
  seller         User         @relation(fields: [sellerId], references: [id])
  sellerId       Int
  createdAt      DateTime     @default(now())
  updatedAt      DateTime     @updatedAt

  // --- NOUVEAUX CHAMPS ---
  bathrooms       Int?         // Nombre de salles de bains (optionnel)
  constructionYear Int?        // Année de construction (optionnel)
  // ----------------------

  @@index([city, type])
  @@index([isSold])
}
